<html>

<head>
    <meta charset="UTF-8">
    <title>QR access</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
    <script type="text/javascript" src="public/qrcode.min.js"></script>
</head>

<body>
    <h4>Access qr code list</h4>
    <a href="/">Home</div>

    <script type="text/javascript">
        function makeCode(text, value) {
            const qrp = document.createElement('p');
            const qrbox = document.createElement('div');
            document.body.appendChild(qrp);
            document.body.appendChild(qrbox);
            qrp.textContent = text + ': ' + value;

            var qrcode = new QRCode(qrbox, {
                width: 200,
                height: 200,
                useSVG: true
            });
            qrcode.makeCode(value);
        }

        const params = new URLSearchParams(window.location.search);
        const str = params.get('k');
        console.log(str)
        const ipMapArr = JSON.parse(str);
        const ipMapKeyIterator = ipMapArr.keys();
        for (const k of ipMapKeyIterator) {
            let interface = ipMapArr[k][0];
            let addr = ipMapArr[k][1][0];
            console.log(`make ${interface} addr: ${addr}`);
            makeCode(interface, addr);
        }

        function testmakeCode() {
            var qrcode = new QRCode(document.getElementById("qrcode"), {
                width: 100,
                height: 100
            });
            qrcode.makeCode("192.168.0.105");
        }

    </script>

</body>

</html>